/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	var parentJsonpFunction = window["webpackJsonp"];
/******/ 	window["webpackJsonp"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [], result;
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/ 		if(executeModules) {
/******/ 			for(i=0; i < executeModules.length; i++) {
/******/ 				result = __webpack_require__(__webpack_require__.s = executeModules[i]);
/******/ 			}
/******/ 		}
/******/ 		return result;
/******/ 	};
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// objects to store loaded and loading chunks
/******/ 	var installedChunks = {
/******/ 		1: 0
/******/ 	};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// on error function for async loading
/******/ 	__webpack_require__.oe = function(err) { console.error(err); throw err; };
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _chart = __webpack_require__(1);

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var miniChart = function () {
    function miniChart(container) {
        _classCallCheck(this, miniChart);

        //版本
        this.version = '1.0';

        this.chart = new _chart.Chart(container);
    }

    _createClass(miniChart, [{
        key: 'setOption',
        value: function setOption() {}

        /*!
         * [init 初始化图表]
         * @return {[Object]} [图表句柄]
         */
        /*!
         * [init description]
         * @param  {[type]} element [description]
         * @return {[type]}         [description]
         */

    }], [{
        key: 'init',
        value: function init(container) {
            return new miniChart(container);
        }
    }]);

    return miniChart;
}();

exports.default = miniChart;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.Chart = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); //引入事件对象


//引入舞台对象


//引入常量名


var _event = __webpack_require__(2);

var _stage = __webpack_require__(3);

var _stage2 = _interopRequireDefault(_stage);

var _constants = __webpack_require__(8);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Chart = exports.Chart = function () {
	function Chart(container) {
		_classCallCheck(this, Chart);

		//DOM容器
		this.container = container;

		//舞台
		this.stage = this.createStage(container);

		//配置选项
		this.option = null;
	}

	/*!
  * [createStage 创建场景]
  */


	_createClass(Chart, [{
		key: 'createStage',
		value: function createStage(container) {
			return new _stage2.default(container);
		}

		/*!
   * [setOption 配置信息]
   */

	}, {
		key: 'setOption',
		value: function setOption(option) {
			this.option = option;
		}
	}]);

	return Chart;
}();

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.Event = Event;

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

//事件对象
var event2D = function event2D(event, callback) {
    _classCallCheck(this, event2D);

    //事件类型
    this.event = event;

    //事件回调
    this.callback = callback;
};

//添加事件


function Event(event, callback) {
    return new event2D(event, callback);
}

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); //引入


var _render = __webpack_require__(4);

var _render2 = _interopRequireDefault(_render);

var _scene = __webpack_require__(5);

var _scene2 = _interopRequireDefault(_scene);

var _tool = __webpack_require__(7);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

//舞台
var Stage = function () {
    function Stage(container) {
        var _this = this;

        _classCallCheck(this, Stage);

        //容器
        this.container = container;

        //场景
        this.sceneList = [];

        //舞台上的影片剪辑
        this.movieclipList = [];

        //舞台的宽和高，既是容器的宽和高，实际也是canvas的宽和高
        this.width = container.clientWidth;
        this.height = container.clientHeight;

        //获取舞台相对于当前视窗的偏移，实际上也是canvas相对于当前视窗的偏移
        this.offset = {
            top: (0, _tool.offsetTop)(container),
            left: (0, _tool.offsetLeft)(container)

            //侦听器容器
        };this.eventlist = [];

        //当前舞台的缩放
        this.scale = 1;

        //当前舞台的偏移
        this.translateX = 0;
        this.translateY = 0;

        //创建并添加一个场景到当前舞台
        this.addScene(this.createScene());

        //缩放事件
        container.addEventListener("DOMMouseScroll", function (e) {
            _this.stageScroll(e);
        }, false);
        //兼容FF
        container.onmousewheel = function (e) {
            _this.stageScroll(e);
        };

        console.log("this.sceneList", this.sceneList);

        //渲染绘制图表
        (0, _render2.default)(function () {
            _this.paintScene();
        });
    }

    _createClass(Stage, [{
        key: 'createScene',
        value: function createScene() {
            return _scene2.default.init(this.container, this.width, this.height);
        }
    }, {
        key: 'addScene',
        value: function addScene(scene) {
            this.sceneList.push(scene);
        }
    }, {
        key: 'stageScroll',
        value: function stageScroll(e) {

            //判定鼠标指针在画布内
            if (Math.abs(e.pageX) > this.offset.left && Math.abs(e.pageX) < this.offset.left + this.width && Math.abs(e.pageY) > this.offset.top && Math.abs(e.pageY) < this.offset.top + this.height) {
                //阻止冒泡
                e.preventDefault();

                //计算出缩放前的鼠标在场景中的 X、Y
                var beforeX = (e.pageX - this.offset.left - this.translateX) / this.scale,
                    beforeY = (e.pageY - this.offset.top - this.translateY) / this.scale;

                if (e.detail > 0 || e.wheelDelta < 0) {
                    if (this.scale > 0.2) this.scale -= .1;
                } else {
                    if (this.scale < 4) this.scale += .1;
                }

                this.translateX = -beforeX * this.scale + (e.pageX - this.offset.left);
                this.translateY = -beforeY * this.scale + (e.pageY - this.offset.top);
            }

            console.log(this.scale);
        }
    }, {
        key: 'paintScene',
        value: function paintScene() {
            var _this2 = this;

            for (var i = 0, len = this.sceneList.length; i < len; i++) {
                // console.log("this.sceneList[" + i + "]", this.sceneList[i])
                this.paint(this.sceneList[i].context);
            }

            (0, _render2.default)(function () {
                _this2.paintScene();
            });
        }

        //重绘核心

    }, {
        key: 'paint',
        value: function paint(context) {

            //清理画面
            context.clearRect(0, 0, this.width, this.height);

            //重置画布的透明度
            context.globalAlpha = 1;

            context.save();

            //重新设定画布偏移和缩放
            context.translate(this.translateX, this.translateY);

            // console.log("this.scale", this.scale);
            context.scale(this.scale, this.scale);

            context.beginPath();
            context.arc(100, 75, 50, 0, 2 * Math.PI);
            context.stroke();

            context.restore();
        }
    }]);

    return Stage;
}();

exports.default = Stage;

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});
//渲染
var Render = function () {
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {
        window.setTimeout(callback, 1000 / 60);
    };
}();

exports.default = Render;

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _movieclip = __webpack_require__(6);

var _movieclip2 = _interopRequireDefault(_movieclip);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

//场景
var Scene = function () {
    function Scene(canvas) {
        var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var height = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

        _classCallCheck(this, Scene);

        this.canvas = canvas;

        this.width = width;
        this.height = height;

        this.context = canvas.getContext('2d');

        //舞台上的影片剪辑
        this.movieclipList = [];

        //舞台上的影片剪辑数量
        this.length = 0;
    }

    _createClass(Scene, [{
        key: 'addChild',
        value: function addChild(id, name, pattern) {
            var mc = new _movieclip2.default(pattern);
            mc.name = name;
            mc.id = id;

            this.movieclipList.push(mc);
            this.length++;

            return mc;
        }
    }], [{
        key: 'init',
        value: function init(container, width, height) {

            //创建 Canvas，并添加到场景
            var canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;

            container.appendChild(canvas);

            return new Scene(canvas, width, height);
        }
    }]);

    return Scene;
}();

exports.default = Scene;

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

//影片剪辑
var MovieClip = function MovieClip(pattern) {
    _classCallCheck(this, MovieClip);

    this.id = undefined;

    this.name = undefined;

    this.pattern = pattern;
};

//影片剪辑群组


exports.default = MovieClip;

var MovieClipGroup = function MovieClipGroup() {
    _classCallCheck(this, MovieClipGroup);

    this.id = undefined;

    this.name = undefined;
};

// /**
//  * 响应事件的元素
//  */
// export class AbioticElement extends Element {
//
// }
//
// /**
//  * 不响应事件的元素
//  */
// export class AbioticElement extends Element {
//
// }

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

exports.offsetTop = offsetTop;
exports.offsetLeft = offsetLeft;

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

//获取元素相对于窗口左边的距离
function offsetTop(elements) {
    var top = elements.offsetTop;
    var parent = elements.offsetParent;
    while (parent != null) {
        top += parent.offsetTop;
        parent = parent.offsetParent;
    }
    return top;
}

//获取元素相对于窗口顶端边的距离
function offsetLeft(elements) {
    var left = elements.offsetLeft;
    var parent = elements.offsetParent;
    while (parent != null) {
        left += parent.offsetLeft;
        parent = parent.offsetParent;
    }
    return left;
}

//防抖和节流

var throttler = function () {
    function throttler() {
        var delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 100;

        _classCallCheck(this, throttler);

        this.delay = delay;
        this.lastTime = new Date().getTime();
    }

    _createClass(throttler, [{
        key: "throttle",
        value: function throttle(fn) {
            var currentTime = new Date().getTime();
            if (currentTime - this.lastTime > this.delay) {
                console.log(currentTime - this.lastTime, this.delay);
                this.lastTime = currentTime;
                fn();
            }
        }
    }], [{
        key: "delay",
        value: function delay(_delay) {
            return new throttler(_delay);
        }
    }]);

    return throttler;
}();

exports.throttler = throttler;

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
//鼠标按下事件
var EVENT_MOUSE_DOWN = exports.EVENT_MOUSE_DOWN = "EVENT_MOUSE_DOWN";

//鼠标移动事件
var EVENT_MOUSE_MOVE = exports.EVENT_MOUSE_MOVE = "EVENT_MOUSE_MOVE";

//鼠标松开事件
var EVENT_MOUSE_UP = exports.EVENT_MOUSE_UP = "EVENT_MOUSE_UP";

//鼠标松开事件
var EVENT_MOUSE_SCROLL = exports.EVENT_MOUSE_SCROLL = "EVENT_MOUSE_SCROLL";

/***/ })
/******/ ]);